---
title: "JavaPoet ä½¿ç”¨æŒ‡å—"
date: 2025-04-21
categories: [ç¼–è¯‘æ—¶æ³¨è§£]
tags: [JavaPoet, è‡ªå®šä¹‰æ³¨è§£]
---



# ğŸ“˜ JavaPoet ä½¿ç”¨æŒ‡å—

> æœ€è¿‘åœ¨å°è¯•ä½¿ç”¨ java çš„è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨åœ¨ç¼–è¯‘æ—¶åšä¸€äº›  bean copy æ“ä½œï¼Œå‘ç°äº†ä¸€ä¸ªå¼ºå¤§çš„ Java æºç ç”Ÿæˆåº“ï¼šJavaPoetã€‚æœ¬æ–‡å°†ä»‹ç» JavaPoet çš„åŸºæœ¬ç”¨æ³•ï¼Œå¹¶æä¾›ä¸€äº›ç¤ºä¾‹ä»£ç ã€‚

> JavaPoet æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ Java æºç ç”Ÿæˆåº“ï¼Œé€‚ç”¨äºæ³¨è§£å¤„ç†å™¨ã€ä»£ç æ¨¡æ¿è‡ªåŠ¨åŒ–ç­‰åœºæ™¯ã€‚

---

## ğŸ“¦ å¼•å…¥ä¾èµ–

### Maven

```xml

<dependency>
    <groupId>com.squareup</groupId>
    <artifactId>javapoet</artifactId>
    <version>1.13.0</version>
</dependency>
```

### Gradle

```groovy
implementation 'com.squareup:javapoet:1.13.0'
```

---

## ğŸ”§ æ ¸å¿ƒç±»æ¦‚è§ˆ

| ç±»å              | æè¿°              |
|-----------------|-----------------|
| `JavaFile`      | ä»£è¡¨ä¸€ä¸ª `.java` æ–‡ä»¶ |
| `TypeSpec`      | è¡¨ç¤ºç±»ã€æ¥å£ã€æšä¸¾ç­‰ç±»å‹å£°æ˜  |
| `MethodSpec`    | è¡¨ç¤ºä¸€ä¸ªæ–¹æ³•          |
| `FieldSpec`     | è¡¨ç¤ºç±»å­—æ®µ           |
| `ParameterSpec` | è¡¨ç¤ºæ–¹æ³•å‚æ•°          |
| `CodeBlock`     | è¡¨ç¤ºæ–¹æ³•ä½“æˆ–è¯­å¥å—       |

---

## ğŸ§ª å¿«é€Ÿç¤ºä¾‹ï¼šç”Ÿæˆä¸€ä¸ªç®€å•ç±»

### ç›®æ ‡ä»£ç ï¼š

```java
package com.example;

public class HelloWorld {
    public static void main(String[] args) {
        System.out.println("Hello, JavaPoet!");
    }
}
```

### JavaPoet ç”Ÿæˆä»£ç ï¼š

```java
import com.squareup.javapoet.*;

import javax.lang.model.element.Modifier;
import java.io.IOException;
import java.nio.file.Paths;

public class JavaPoetExample {
    public static void main(String[] args) throws IOException {
        MethodSpec main = MethodSpec.methodBuilder("main")
                .addModifiers(Modifier.PUBLIC, Modifier.STATIC)
                .returns(void.class)
                .addParameter(String[].class, "args")
                .addStatement("$T.out.println($S)", System.class, "Hello, JavaPoet!")
                .build();

        TypeSpec helloWorld = TypeSpec.classBuilder("HelloWorld")
                .addModifiers(Modifier.PUBLIC)
                .addMethod(main)
                .build();

        JavaFile javaFile = JavaFile.builder("com.example", helloWorld)
                .build();

        javaFile.writeTo(Paths.get("./src")); // è¾“å‡ºåˆ° src ç›®å½•
    }
}
```

---

## ğŸ§± æ„å»ºç»„ä»¶è¯¦è§£

### âœ³ï¸ åˆ›å»ºå­—æ®µï¼ˆFieldSpecï¼‰

```java
FieldSpec field = FieldSpec.builder(String.class, "name", Modifier.PRIVATE)
        .initializer("$S", "JavaPoet")
        .build();
```

### âœ³ï¸ åˆ›å»ºæ„é€ æ–¹æ³•

```java
MethodSpec constructor = MethodSpec.constructorBuilder()
        .addModifiers(Modifier.PUBLIC)
        .addParameter(String.class, "name")
        .addStatement("this.name = name")
        .build();
```

### âœ³ï¸ åˆ›å»ºæ™®é€šæ–¹æ³•

```java
MethodSpec method = MethodSpec.methodBuilder("getName")
        .addModifiers(Modifier.PUBLIC)
        .returns(String.class)
        .addStatement("return this.name")
        .build();
```

### âœ³ï¸ æ·»åŠ æ³¨è§£

```java
MethodSpec method = MethodSpec.methodBuilder("toString")
        .addAnnotation(Override.class)
        .addModifiers(Modifier.PUBLIC)
        .returns(String.class)
        .addStatement("return name")
        .build();
```

---

## ğŸ’¡ å ä½ç¬¦è¯´æ˜ï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰

| å ä½ç¬¦  | å«ä¹‰          |
|------|-------------|
| `$S` | å­—ç¬¦ä¸²ï¼Œä¼šè‡ªåŠ¨åŠ åŒå¼•å· |
| `$T` | ç±»å‹ï¼Œä¼šè‡ªåŠ¨å¯¼å…¥åŒ…   |
| `$L` | å­—é¢é‡ï¼ˆç›´æ¥è¾“å‡ºï¼‰   |
| `$N` | åç§°ï¼ˆå˜é‡ã€æ–¹æ³•ç­‰ï¼‰  |

---

## ğŸ“ è¾“å‡º Java æ–‡ä»¶

```java
JavaFile javaFile = JavaFile.builder("com.example", typeSpec)
        .build();

javaFile.writeTo(Paths.get("src/main/java"));
```

---

## ğŸ“š å¸¸è§ä½¿ç”¨åœºæ™¯

- æ³¨è§£å¤„ç†å™¨ä¸­ç”Ÿæˆ Java æºç 
- è‡ªåŠ¨ç”Ÿæˆæ¨¡æ¿ä»£ç ï¼ˆå¦‚ Getter/Setterã€Builderï¼‰
- Android å¼€å‘ä¸­çš„ Roomã€Dagger ç­‰æ¡†æ¶
- ç¼–è¯‘æœŸä»£ç å¢å¼ºï¼ˆAPTï¼‰

---

## ğŸ“Œ é™„åŠ ï¼šCodeBlock ç¤ºä¾‹

æ„å»ºä¸€ä¸ªè‡ªå®šä¹‰è¯­å¥å—ï¼š

```java
CodeBlock block = CodeBlock.builder()
        .addStatement("int total = 0")
        .beginControlFlow("for (int i = 0; i < 10; i++)")
        .addStatement("total += i")
        .endControlFlow()
        .build();
```

ç”¨äºæ–¹æ³•ä½“ï¼š

```java
MethodSpec method = MethodSpec.methodBuilder("calculateSum")
        .addModifiers(Modifier.PUBLIC)
        .returns(int.class)
        .addCode(block)
        .addStatement("return total")
        .build();
```

---

## âœ… å°è´´å£«

- ä½¿ç”¨ `$T` æ›¿ä»£å…¨ç±»åï¼ŒJavaPoet è‡ªåŠ¨å¤„ç† import
- å¤šä¸ª `addStatement()` ç»„åˆå¯ä»¥æ„é€ å®Œæ•´æ–¹æ³•ä½“
- `CodeBlock` æ”¯æŒåµŒå¥—è¯­æ³•å’Œå¤æ‚é€»è¾‘
- `JavaFile.toString()` å¯ä»¥ç›´æ¥è¾“å‡ºæºç å†…å®¹

---

## ğŸ§° å¸¸è§é—®é¢˜

### Q: å¦‚ä½•å†™å…¥æ–‡ä»¶ï¼Ÿ

ä½¿ç”¨ `writeTo(Paths.get(...))` æˆ– `writeTo(System.out)`ã€‚

### Q: å¦‚ä½•é¿å… import å†²çªï¼Ÿ

JavaPoet ä¼šè‡ªåŠ¨å¤„ç† importï¼Œå¹¶é¿å…é‡å¤ã€‚

### Q: èƒ½ç”Ÿæˆæ³›å‹ã€æ³¨è§£ã€æ¥å£å—ï¼Ÿ

å¯ä»¥ï¼ŒJavaPoet æ”¯æŒè¿™äº›ç‰¹æ€§ï¼Œé€šè¿‡ `TypeSpec.interfaceBuilder()`ã€`addAnnotation()` ç­‰æ–¹æ³•å®ç°ã€‚
